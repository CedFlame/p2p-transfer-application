# Описание приложения P2P-переводов

## Автор
- ФИО: Шматов Олег Сергеевич
- Университет: Российский университет транспорта
- Город: Москва

## Цель проекта
Веб-приложение «P2P-переводы» предназначено для безопасных переводов денег между счетами пользователей. Приложение позволяет пользователям регистрироваться, управлять своими счетами и осуществлять переводы средств между счетами.

## Функциональность
- **Управление пользователями:** Регистрация новых пользователей и аутентификация (вход в систему).
- **Управление счетами:** Пользователь может иметь несколько счетов (кошельков). Реализован просмотр баланса по счету, открытие новых счетов с начальным балансом и закрытие счетов.
- **P2P-переводы:** Пользователь может перевести деньги на счет другого пользователя:
    - Выбирается счет-источник, указывается счет-получатель и сумма перевода.
    - При попытке перевода выполняется валидация (достаточность средств на счёте-источнике, существование счёта-получателя). При успешной проверке генерируется одноразовый код подтверждения (OTP), который отображается пользователю.
    - После ввода пользователем корректного OTP перевод выполняется: сумма списывается с счета-источника и зачисляется на счет-получателя, а статус транзакции обновляется на «успешно».

## Техническая реализация
- **Стек технологий:** Java 17, Spring Boot 2.7, RESTful API (Swagger/OpenAPI документация), PostgreSQL (база данных), Redis (кэш/хранилище OTP-кодов).
- **Архитектура:** Многоуровневое приложение с разделением на слои: контроллеры (REST API endpoints), сервисы (бизнес-логика), репозитории (JdbcTemplate для работы с БД). Конфигурация бинов выполнена явно через классы с аннотацией `@Configuration`. Проект разбит на несколько модулей: основной сервис (бизнес-логика), модуль интерфейса (Telegram-бот) и общая библиотека DTO.
- **Работа с данными:** Вместо ORM применяется чистый JDBC (`JdbcTemplate`), SQL-запросы написаны вручную. Денежные суммы хранятся в виде целых чисел (например, в копейках) для сохранения точности расчетов (BigDecimal не использовался).
- **Безопасность:** Реализована JWT-аутентификация. Telegram-бот получает имя пользователя из сообщений и использует JWT-токен для взаимодействия с бэкендом, выполняя авторизацию запросов.
- **Обработка ошибок:** Настроен глобальный обработчик исключений (`@ControllerAdvice`) для единообразных ответов об ошибках. Предусмотрены разные типы ошибок с собственными классами исключений (например, недостаточно средств, счет не найден, неверный OTP и др.). Все ключевые ошибки и действия записываются в лог.
- **Логирование и метрики:** Логируются основные операции (регистрация, переводы, ошибки). Замеряется время выполнения важных методов для мониторинга производительности.
- **Тестирование:** Покрытие модульными и интеграционными тестами превышает 70% (требование выполнено).

## Особенности реализации
- **Модель данных:** Предусмотрены отдельные сущности для пользователя, аккаунта и баланса. `User` хранит данные для аутентификации и связывается с аккаунтами. `Account` представляет кошелёк пользователя, а `Balance` хранит текущую сумму на счёте. Разделение `Account` и `Balance` упрощает управление несколькими счетами и ведение истории транзакций.
- **Транзакции переводов:** Перевод оформляется как транзакция со статусами (например, «ожидание подтверждения», «успешно», «отклонено»). При инициации перевода создаётся запись транзакции (статус «в ожидании») и генерируется OTP-код. После подтверждения пользователем OTP транзакция помечается выполненной и производится фактическое списание/зачисление средств. Такой подход повышает безопасность и отслеживаемость операций.
- **Интерфейс (Telegram-бот):** Вместо веб-интерфейса реализован чат-бот в Telegram. Бот (Spring Boot + Telegram API) позволяет регистрироваться, просматривать счета, выполнять переводы через текстовые команды. Такой подход выбран из личных предпочтений и для экономии времени (не создавался отдельный веб-клиент). Бот реализует базовый функционал, однако пока охватывает не все сценарии и требует дальнейшего улучшения (например, более гибкая обработка диалога и ошибок).

## Деплой
- Деплоя небыло, все реализовано на localhost, из-за нехватки времени и знаний по деплою.
## Использование LLM
В ходе разработки активно использовались большие языковые модели (LLM) для ускорения и улучшения процесса:
- **Генерация кода и рефакторинг:** LLM помогала быстро писать шаблонный код (Проверки безопасности, репозитории и др.), а также предлагала более элегантные и эффективные решения при рефакторинге, что ускорило разработку и улучшило качество кода.
- **Написание тестов:** LLM значительно ускорила создание тестов. Разработчик описывал сценарии и ожидаемое поведение, а модель генерировала основу тест-кейсов, которые затем дорабатывались под требования проекта. Это позволило достичь требуемого уровня покрытия, учитывая ограниченный опыт в написании тестов вручную.
## Комментарий

Данное задание было выполнено в период с 4 по 8 июля (до 7 утра). В начале месяца, 1 и 2 июля, я готовился и сдавал экзамен по физике в рамках сессии в университете. 3 июля был мой день рождения, что также отняло часть времени. Несмотря на эти обстоятельства, удалось качественно (надеюсь) реализовать все требования проекта.

Хочу отметить, что я открыт к новым знаниям и стремлюсь постоянно развиваться. Готов учиться и стажироваться, чтобы профессионально расти и вносить значимый вклад в команду, в частности, рассматриваю возможность работы и обучения в РБС.
